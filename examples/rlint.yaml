name: rlint
language: rust
rules:
  env_string_literals:
    severity: warn
    category: foo
    message: Calls to (std::|)env::(var|remove_var) should not use string literals
    query: |
      ((call_expression
        function: (_) @function
        arguments: (arguments (string_literal))) @raise
      (#match? @function "(std::|)env::(var|remove_var)"))
    captures:
      - raise
  cast_abs_to_unsigned:
    severity: deny
    category: bar
    message: Shouldn't cast `abs()` to unsigned
    query: |
      (let_declaration
        (type_cast_expression
          (call_expression) @call
          (primitive_type) @type
          (#match? @call "abs")
          (#match? @type "u8|u16|u32|u64")
        )
      ) @raise
    captures:
      - raise
